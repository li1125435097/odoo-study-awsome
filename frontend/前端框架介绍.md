Odoo 17 çš„å‰ç«¯æ¶æ„å·²å…¨é¢ç°ä»£åŒ–ï¼Œ**å®Œå…¨åŸºäº OWLï¼ˆOdoo Web Libraryï¼‰2.x**ï¼Œè¿™æ˜¯ä¸€ä¸ªç”± Odoo å›¢é˜Ÿè‡ªä¸»ç ”å‘çš„è½»é‡çº§ã€å“åº”å¼ã€ç»„ä»¶åŒ– JavaScript æ¡†æ¶ï¼Œçµæ„Ÿæ¥æºäº React å’Œ Vueï¼Œä½†ä¸“ä¸º Odoo çš„ä¸šåŠ¡åœºæ™¯ä¼˜åŒ–ã€‚

ä»¥ä¸‹æ˜¯å¯¹ **Odoo 17 å‰ç«¯æ¡†æ¶ç»“æ„** çš„ç³»ç»Ÿæ€§ä»‹ç»ï¼Œæ¶µç›–æ ¸å¿ƒç†å¿µã€æŠ€æœ¯æ ˆã€ç›®å½•ç»“æ„ã€ç»„ä»¶æ¨¡å‹ã€æ•°æ®æµã€æœåŠ¡æœºåˆ¶åŠå¼€å‘å®è·µã€‚

---

## ä¸€ã€æ ¸å¿ƒæ¶æ„æ¦‚è§ˆ

| å±‚çº§ | æŠ€æœ¯/æ¨¡å— | è¯´æ˜ |
|------|----------|------|
| **è§†å›¾å±‚** | OWL 2.x | ç»„ä»¶åŒ– UI æ¸²æŸ“å¼•æ“ï¼ˆåŸºäº VDOM + Reactive çŠ¶æ€ï¼‰ |
| **çŠ¶æ€ç®¡ç†** | å†…ç½®å“åº”å¼ç³»ç»Ÿï¼ˆ`useState`, `useRef`ï¼‰ | æ—  Redux/Vuexï¼ŒçŠ¶æ€åœ¨ç»„ä»¶å†…æˆ–é€šè¿‡æœåŠ¡å…±äº« |
| **é€šä¿¡æœºåˆ¶** | Servicesï¼ˆæœåŠ¡æ³¨å†Œè¡¨ï¼‰ | è§£è€¦ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚ RPCã€é€šçŸ¥ã€åŠ¨ä½œï¼‰ |
| **æ¨¡æ¿å¼•æ“** | QWebï¼ˆXML-basedï¼‰ | å£°æ˜å¼æ¨¡æ¿ï¼Œæ”¯æŒæ¡ä»¶ã€å¾ªç¯ã€ç»„ä»¶åµŒå…¥ |
| **æ„å»ºå·¥å…·** | ESBuild + è‡ªå®šä¹‰ Asset Pipeline | å¿«é€Ÿæ‰“åŒ… JS/CSS/XML èµ„æº |
| **å…¼å®¹å±‚** | æ—  jQuery / Backbone | å®Œå…¨ç§»é™¤æ—§ç‰ˆä¾èµ–ï¼ˆOdoo 15 åŠä¹‹å‰ä½¿ç”¨ Backboneï¼‰ |

> âœ… **å…³é”®å˜åŒ–**ï¼šOdoo 16+ å½»åº•å¼ƒç”¨æ—§ Widget ç³»ç»Ÿï¼Œå…¨é¢æ‹¥æŠ± OWL + Hooks ç¼–ç¨‹æ¨¡å‹ã€‚

---

## äºŒã€æ ¸å¿ƒæ¦‚å¿µè¯¦è§£

### 1. **OWLï¼ˆOdoo Web Libraryï¼‰2.x**
- **å“åº”å¼**ï¼šä½¿ç”¨ `useState()` è‡ªåŠ¨è¿½è¸ªçŠ¶æ€å˜åŒ–å¹¶è§¦å‘é‡æ¸²æŸ“ã€‚
- **ç»„ä»¶åŒ–**ï¼šæ¯ä¸ª UI å•å…ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹ç»„ä»¶ï¼ˆ`.js` + `.xml`ï¼‰ã€‚
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šæ”¯æŒ `setup()`ï¼ˆæ›¿ä»£ constructorï¼‰ã€`willStart()`ã€`mounted()` ç­‰é’©å­ã€‚
- **æ¨¡æ¿ç»‘å®š**ï¼šé€šè¿‡ `t-` æŒ‡ä»¤ï¼ˆå¦‚ `t-if`, `t-for`, `t-on-click`ï¼‰å®ç°å£°æ˜å¼ UIã€‚

```js
// ç¤ºä¾‹ï¼šç®€å•è®¡æ•°å™¨ç»„ä»¶
import { Component, useState } from "@odoo/owl";

export class Counter extends Component {
    static template = "my_module.Counter";
    setup() {
        this.state = useState({ count: 0 });
    }
    increment() {
        this.state.count++;
    }
}
```

```xml
<!-- æ¨¡æ¿ -->
<t t-name="my_module.Counter">
    <div>
        Count: <t t-esc="state.count"/>
        <button t-on-click="increment">+1</button>
    </div>
</t>
```

---

### 2. **Servicesï¼ˆæœåŠ¡ç³»ç»Ÿï¼‰**
Odoo 17 ä½¿ç”¨ **æœåŠ¡æ³¨å†Œè¡¨ï¼ˆService Registryï¼‰** ç®¡ç†å…¨å±€åŠŸèƒ½ï¼Œæ›¿ä»£æ—§ç‰ˆ `this._rpc()` ç›´æ¥è°ƒç”¨ã€‚

å¸¸ç”¨æœåŠ¡ï¼š
| æœåŠ¡å | ç”¨é€” |
|--------|------|
| `orm` | è°ƒç”¨æ¨¡å‹æ–¹æ³•ï¼ˆ`orm.call(model, method, args)`ï¼‰ |
| `rpc` | åº•å±‚ RPC è°ƒç”¨ï¼ˆä¸æ¨èç›´æ¥ä½¿ç”¨ï¼‰ |
| `action` | æ‰§è¡Œ Actionï¼ˆæ‰“å¼€çª—å£ã€è·³è½¬ç­‰ï¼‰ |
| `notification` | æ˜¾ç¤ºé€šçŸ¥ï¼ˆæˆåŠŸ/è­¦å‘Š/é”™è¯¯ï¼‰ |
| `user` | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| `company` | è·å–å½“å‰å…¬å¸ä¿¡æ¯ |

#### ä½¿ç”¨æ–¹å¼ï¼ˆHooks é£æ ¼ï¼‰ï¼š
```js
import { useService } from "@web/core/utils/hooks";

setup() {
    this.orm = useService("orm");
    this.action = useService("action");
    this.notification = useService("notification");
}

async saveRecord() {
    await this.orm.call("my.model", "custom_method", [this.props.record.resId]);
    this.notification.add("Saved!", { type: "success" });
}
```

---

### 3. **è§†å›¾ç³»ç»Ÿï¼ˆView Systemï¼‰**
Odoo 17 çš„è§†å›¾ï¼ˆForm/List/Kanban ç­‰ï¼‰æœ¬èº«ä¹Ÿæ˜¯ **OWL ç»„ä»¶**ï¼Œå¯é€šè¿‡ç»§æ‰¿æˆ–æ›¿æ¢å®ç°æ·±åº¦å®šåˆ¶ã€‚

- **å­—æ®µç»„ä»¶**ï¼šæ‰€æœ‰ `<field>` æ¸²æŸ“ä¸º `FieldComponent` å­ç±»ã€‚
- **æ§åˆ¶å™¨**ï¼šæ¯ä¸ªè§†å›¾æœ‰å¯¹åº” Controllerï¼ˆå¦‚ `FormController`ï¼‰ï¼Œå¤„ç†äº¤äº’é€»è¾‘ã€‚
- **ArchParser**ï¼šå°† XML è§†å›¾å®šä¹‰è§£æä¸º JS å¯¹è±¡æ ‘ï¼Œä¾›ç»„ä»¶æ¶ˆè´¹ã€‚

#### è‡ªå®šä¹‰å­—æ®µç»„ä»¶æ³¨å†Œï¼š
```js
import { registry } from "@web/core/registry";
import { FieldChar } from "@web/views/fields/char/char_field";

class MyCustomField extends FieldChar { /* ... */ }

registry.category("fields").add("my_custom_widget", MyCustomField);
```

åœ¨ XML ä¸­ä½¿ç”¨ï¼š
```xml
<field name="my_field" widget="my_custom_widget"/>
```

---

### 4. **èµ„äº§ï¼ˆAssetsï¼‰ç³»ç»Ÿ**
å‰ç«¯èµ„æºé€šè¿‡ `__manifest__.py` å£°æ˜ï¼ŒæŒ‰éœ€åŠ è½½ï¼š

```python
# __manifest__.py
'assets': {
    'web.assets_backend': [
        'my_module/static/src/js/**/*',
        'my_module/static/src/xml/**/*',  # XML æ¨¡æ¿è‡ªåŠ¨åŠ è½½
        'my_module/static/src/scss/**/*',
    ],
    'web.assets_tests': [
        'my_module/static/tests/**/*',
    ],
},
```

- **è‡ªåŠ¨æ¨¡æ¿åŠ è½½**ï¼šæ‰€æœ‰ `static/src/**/*.xml` æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨æ”¶é›†ä¸º QWeb æ¨¡æ¿ã€‚
- **SCSS æ”¯æŒ**ï¼šä½¿ç”¨ Bootstrap 5 + Odoo è‡ªå®šä¹‰å˜é‡ã€‚

---

## ä¸‰ã€å…¸å‹å‰ç«¯ç›®å½•ç»“æ„ï¼ˆOdoo 17 æ¨¡å—ï¼‰

```
my_module/
â”œâ”€â”€ static/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ components/          # è‡ªå®šä¹‰ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ my_widget/
â”‚       â”‚   â”‚   â”œâ”€â”€ my_widget.js
â”‚       â”‚   â”‚   â””â”€â”€ my_widget.xml
â”‚       â”œâ”€â”€ views/               # è§†å›¾æ‰©å±•ï¼ˆå¦‚è‡ªå®šä¹‰ Kanban æ§åˆ¶å™¨ï¼‰
â”‚       â”œâ”€â”€ scss/                # æ ·å¼
â”‚       â”‚   â””â”€â”€ my_module.scss
â”‚       â””â”€â”€ js/
â”‚           â””â”€â”€ my_module.js     # å…¥å£æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ views/
â”‚   â””â”€â”€ my_model_views.xml       # åç«¯è§†å›¾å®šä¹‰
â””â”€â”€ __manifest__.py
```

---

## å››ã€æ•°æ®æµä¸é€šä¿¡æœºåˆ¶

### 1. **çˆ¶å­ç»„ä»¶é€šä¿¡**
- **Props**ï¼šçˆ¶ â†’ å­ï¼ˆåªè¯»ï¼‰
- **Events**ï¼šå­ â†’ çˆ¶ï¼ˆé€šè¿‡ `$emit` æˆ–å›è°ƒå‡½æ•°ï¼‰

### 2. **å…¨å±€çŠ¶æ€å…±äº«**
- é€šè¿‡ **Services** å®ç°ï¼ˆå¦‚ `user` æœåŠ¡æä¾›å½“å‰ç”¨æˆ·ï¼‰ã€‚
- ä¸é¼“åŠ±å…¨å±€çŠ¶æ€åº“ï¼ˆå¦‚ Vuexï¼‰ï¼Œé™¤éå¤æ‚åœºæ™¯ã€‚

### 3. **ä¸åç«¯äº¤äº’**
```js
// æ¨èï¼šä½¿ç”¨ orm æœåŠ¡
const result = await this.orm.call("res.partner", "search_read", [[], ["name"]]);

// æˆ–è°ƒç”¨è‡ªå®šä¹‰æ–¹æ³•
await this.orm.call("my.model", "my_custom_method", [recordId], { context: {} });
```

---

## äº”ã€è°ƒè¯•ä¸å¼€å‘å·¥å…·

1. **æµè§ˆå™¨å¼€å‘è€…å·¥å…·**
   - æŸ¥çœ‹ç»„ä»¶æ ‘ï¼ˆéœ€å¯ç”¨ Owl DevTools æ‰©å±•ï¼‰
   - ç›‘æ§ç½‘ç»œè¯·æ±‚ï¼ˆRPC è°ƒç”¨ï¼‰

2. **Odoo å†…ç½®è°ƒè¯•**
   - å¼€å¯ **Developer Mode**
   - ä½¿ç”¨ `console.log` æˆ– `debugger`

3. **çƒ­é‡è½½**
   - ä¿®æ”¹ JS/XML/SCSS ååˆ·æ–°é¡µé¢å³å¯ç”Ÿæ•ˆï¼ˆæ— éœ€é‡å¯æœåŠ¡ï¼‰

---

## å…­ã€ä¸æ—§ç‰ˆæœ¬å¯¹æ¯”ï¼ˆOdoo 15 vs 17ï¼‰

| ç‰¹æ€§ | Odoo 15ï¼ˆåŠæ›´æ—©ï¼‰ | Odoo 17 |
|------|------------------|--------|
| æ¡†æ¶ | Backbone.js + jQuery | OWL 2.xï¼ˆçº¯ç°ä»£ JSï¼‰ |
| ç»„ä»¶æ¨¡å‹ | Class-based Widgets | Function/Hooks + Class Components |
| çŠ¶æ€ç®¡ç† | æ‰‹åŠ¨ç®¡ç† | å†…ç½®å“åº”å¼ (`useState`) |
| æ¨¡æ¿ | QWebï¼ˆç±»ä¼¼ï¼‰ | QWebï¼ˆå¢å¼ºï¼Œæ”¯æŒ `t-component`ï¼‰ |
| å­—æ®µæ‰©å±• | ç»§æ‰¿ `FieldWidget` | ç»§æ‰¿ `FieldComponent` |
| æ„å»ºå·¥å…· | Gulp + Babel | ESBuildï¼ˆæ›´å¿«ï¼‰ |

---

## ä¸ƒã€æ€»ç»“ï¼šOdoo 17 å‰ç«¯æ ¸å¿ƒä¼˜åŠ¿

- âœ… **ç°ä»£åŒ–**ï¼šæ‹¥æŠ±ç»„ä»¶åŒ–ã€å“åº”å¼ã€Hooks ç¼–ç¨‹ã€‚
- âœ… **é«˜æ€§èƒ½**ï¼šOWL è½»é‡ï¼ˆ<10KBï¼‰ï¼ŒVDOM ä¼˜åŒ–æ¸²æŸ“ã€‚
- âœ… **å¯ç»´æŠ¤**ï¼šæ¸…æ™°çš„åˆ†å±‚ï¼ˆç»„ä»¶/æœåŠ¡/è§†å›¾ï¼‰ã€‚
- âœ… **æ·±åº¦é›†æˆ**ï¼šä¸ Odoo åç«¯æ— ç¼åä½œï¼ˆORMã€Actionã€Contextï¼‰ã€‚
- âœ… **å¼€å‘è€…å‹å¥½**ï¼šçƒ­é‡è½½ã€æ¸…æ™°çš„é”™è¯¯æç¤ºã€æ¨¡å—åŒ–ç»“æ„ã€‚

---

## ğŸ“š å®˜æ–¹å‚è€ƒ

- [Odoo 17 Frontend Documentation](https://www.odoo.com/documentation/17.0/developer/misc/technical_overview.html)
- [OWL Official Guide](https://odoo.github.io/owl/)
- [Odoo Web Core Source Code](https://github.com/odoo/odoo/tree/17.0/addons/web)

---

å¦‚éœ€å…·ä½“åœºæ™¯ç¤ºä¾‹ï¼ˆå¦‚â€œå¦‚ä½•åœ¨ Form è§†å›¾ä¸­åµŒå…¥ ECharts å›¾è¡¨â€æˆ–â€œè‡ªå®šä¹‰ Kanban å¡ç‰‡æ‹–æ‹½é€»è¾‘â€ï¼‰ï¼Œå¯è¿›ä¸€æ­¥å±•å¼€ã€‚