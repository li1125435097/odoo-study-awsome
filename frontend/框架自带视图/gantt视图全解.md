åœ¨ **Odoo 17** ä¸­ï¼Œ`<gantt>` è§†å›¾æ˜¯ä¸€ç§ç”¨äº**é¡¹ç›®è®¡åˆ’ä¸ä»»åŠ¡è°ƒåº¦**çš„å¯è§†åŒ–è§†å›¾ï¼Œä»¥æ—¶é—´è½´å½¢å¼å±•ç¤ºä»»åŠ¡çš„å¼€å§‹/ç»“æŸæ—¶é—´ã€è¿›åº¦ã€ä¾èµ–å…³ç³»ç­‰ã€‚å®ƒç±»ä¼¼äº Microsoft Project çš„ç”˜ç‰¹å›¾ã€‚

> âš ï¸ **é‡è¦å‰æ**ï¼š  
> `<gantt>` è§†å›¾ **ä»…åœ¨ Odoo Enterpriseï¼ˆä¼ä¸šç‰ˆï¼‰ä¸­å¯ç”¨**ï¼Œç¤¾åŒºç‰ˆï¼ˆCommunityï¼‰**ä¸æ”¯æŒ**ã€‚å…¶åŠŸèƒ½ç”± `web_gantt` æ¨¡å—æä¾›ï¼ˆè¯¥æ¨¡å—ä»…å­˜åœ¨äº Enterprise ä»£ç åº“ï¼‰ã€‚

---

## âœ… å®Œæ•´ç¤ºä¾‹ï¼šåŒ…å«æ‰€æœ‰å¯ç”¨å±æ€§çš„ Gantt è§†å›¾ XMLï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰

```xml
<!-- æ–‡ä»¶ï¼šviews/project_task_gantt_view.xml -->
<odoo>
    <record id="view_project_task_gantt" model="ir.ui.view">
        <field name="name">project.task.gantt</field>
        <field name="model">project.task</field>
        <field name="arch" type="xml">
            <!-- 
                <gantt> æ ¹å…ƒç´ æ”¯æŒå¤šä¸ªå…³é”®å±æ€§ï¼Œç”¨äºæ§åˆ¶æ—¶é—´è½´ã€åˆ†ç»„ã€ä¾èµ–ç­‰
            -->
            <gantt
                date_start="date_start"          <!-- å¿…å¡«ï¼šä»»åŠ¡å¼€å§‹æ—¥æœŸå­—æ®µ -->
                date_stop="date_end"             <!-- å¯é€‰ï¼šä»»åŠ¡ç»“æŸæ—¥æœŸå­—æ®µï¼ˆè‹¥æ— ï¼Œåˆ™ç”¨ duration è®¡ç®—ï¼‰ -->
                date_delay="planned_hours"       <!-- å¯é€‰ï¼šæŒç»­æ—¶é—´å­—æ®µï¼ˆå•ä½ï¼šå°æ—¶ï¼‰ï¼Œç”¨äºè®¡ç®— date_stop -->
                string="Project Tasks"           <!-- è§†å›¾æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰ -->
                type="task"                      <!-- ä»»åŠ¡ç±»å‹ï¼ˆå¯é€‰ï¼Œé»˜è®¤ 'task'ï¼‰ -->
                mode="week"                      <!-- åˆå§‹æ—¶é—´åˆ»åº¦ï¼š'day', 'week', 'month', 'year' -->
                class="o_project_gantt"          <!-- æ·»åŠ  CSS ç±» -->
                js_class="custom_gantt_controller" <!-- è‡ªå®šä¹‰ JS æ§åˆ¶å™¨ï¼ˆé«˜çº§ç”¨æ³•ï¼‰ -->
                sample="False"                   <!-- å¯ç”¨ç¤ºä¾‹æ•°æ®ï¼ˆå¼€å‘è°ƒè¯•ç”¨ï¼‰ -->
                dependency_arrow="dependency_task_ids" <!-- ä»»åŠ¡ä¾èµ–å­—æ®µï¼ˆMany2many æˆ– Many2oneï¼‰ -->
                progress="progress"              <!-- è¿›åº¦ç™¾åˆ†æ¯”å­—æ®µï¼ˆ0-100ï¼‰ -->
                consolidation="False"            <!-- æ˜¯å¦å¯ç”¨åˆå¹¶æ¨¡å¼ï¼ˆé»˜è®¤ Falseï¼‰ -->
                consolidate_by="user_id"         <!-- åˆå¹¶ä¾æ®å­—æ®µï¼ˆéœ€ consolidation="True"ï¼‰ -->
                default_group_by="project_id"    <!-- é»˜è®¤åˆ†ç»„å­—æ®µ -->
                colors="red:priority=='1';orange:priority=='2'" <!-- åŠ¨æ€é¢œè‰²è§„åˆ™ -->
                >
                
                <!-- 
                    å­—æ®µå£°æ˜ï¼š
                    - æ‰€æœ‰åœ¨å¡ç‰‡ä¸­æ˜¾ç¤ºæˆ–ç”¨äºé€»è¾‘çš„å­—æ®µå¿…é¡»åœ¨æ­¤å£°æ˜
                    - ä¸æ”¯æŒ widgetã€options ç­‰å±æ€§
                -->
                <field name="name"/>               <!-- ä»»åŠ¡åç§°ï¼ˆè‡ªåŠ¨æ˜¾ç¤ºåœ¨å¡ç‰‡ä¸Šï¼‰ -->
                <field name="project_id"/>         <!-- ç”¨äºåˆ†ç»„ -->
                <field name="user_id"/>            <!-- è´Ÿè´£äºº -->
                <field name="priority"/>           <!-- ç”¨äº colors å’Œé€»è¾‘ -->
                <field name="progress"/>           <!-- è¿›åº¦æ¡ -->
                <field name="date_start"/>
                <field name="date_end"/>
                <field name="planned_hours"/>
                <field name="dependency_task_ids"/> <!-- ä»»åŠ¡ä¾èµ– -->

                <!-- 
                    åŠ¨æ€æ ·å¼ï¼ˆDecorationï¼‰
                    æ³¨æ„ï¼šåœ¨ gantt ä¸­ï¼Œdecoration ä½œç”¨äºä»»åŠ¡å¡ç‰‡
                -->
                <attribute name="decoration-danger">priority == '1'</attribute>
                <attribute name="decoration-warning">progress &lt; 50</attribute>

            </gantt>
        </field>
    </record>
</odoo>
```

> ğŸ’¡ **å…³é”®è¯´æ˜**ï¼š
> - **`date_start` æ˜¯å”¯ä¸€å¿…å¡«å±æ€§**ï¼Œå…¶ä»–æ—¶é—´ç›¸å…³å­—æ®µå¯ç»„åˆä½¿ç”¨ã€‚
> - **`dependency_arrow`**ï¼šç»˜åˆ¶ä»»åŠ¡é—´çš„ä¾èµ–ç®­å¤´ï¼ˆéœ€å­—æ®µä¸º `Many2many` æˆ– `Many2one` æŒ‡å‘åŒæ¨¡å‹ï¼‰ã€‚
> - **`colors`**ï¼šåŸºäºå­—æ®µå€¼åŠ¨æ€è®¾ç½®å¡ç‰‡èƒŒæ™¯è‰²ï¼ˆè¯­æ³•ï¼š`color: condition; ...`ï¼‰ã€‚
> - **`default_group_by`**ï¼šé¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æŒ‰æ­¤å­—æ®µåˆ†ç»„ï¼ˆå¦‚æŒ‰é¡¹ç›®ã€è´Ÿè´£äººï¼‰ã€‚
> - **`mode`**ï¼šæ§åˆ¶åˆå§‹æ—¶é—´åˆ»åº¦ï¼ˆç”¨æˆ·å¯æ‰‹åŠ¨åˆ‡æ¢ï¼‰ã€‚

---

## ğŸ“š Gantt è§†å›¾æ‰€æœ‰å¯æ“ä½œå±æ€§æ€»ç»“

### ä¸€ã€`<gantt>` æ ¹å…ƒç´ å±æ€§

| å±æ€§ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `date_start` | âœ… æ˜¯ | â€” | ä»»åŠ¡å¼€å§‹æ—¥æœŸå­—æ®µï¼ˆ`Date` æˆ– `Datetime`ï¼‰ |
| `date_stop` | âŒ å¦ | â€” | ä»»åŠ¡ç»“æŸæ—¥æœŸå­—æ®µï¼ˆè‹¥æœªè®¾ï¼Œç”¨ `date_start + date_delay` è®¡ç®—ï¼‰ |
| `date_delay` | âŒ å¦ | â€” | æŒç»­æ—¶é—´å­—æ®µï¼ˆå•ä½ï¼š**å°æ—¶**ï¼‰ï¼Œç”¨äºè®¡ç®— `date_stop` |
| `string` | âŒ å¦ | æ¨¡å‹å | è§†å›¾æ ‡é¢˜ï¼ˆæ˜¾ç¤ºåœ¨è§†å›¾åˆ‡æ¢æ ï¼‰ |
| `type` | âŒ å¦ | `'task'` | ä»»åŠ¡ç±»å‹ï¼ˆå½±å“ UI å›¾æ ‡ï¼Œå¯é€‰ `'milestone'`ï¼‰ |
| `mode` | âŒ å¦ | `'week'` | åˆå§‹æ—¶é—´åˆ»åº¦ï¼š`'day'`, `'week'`, `'month'`, `'year'` |
| `class` | âŒ å¦ | â€” | æ·»åŠ  CSS ç±»åˆ° Gantt å®¹å™¨ |
| `js_class` | âŒ å¦ | â€” | æŒ‡å®šè‡ªå®šä¹‰ JS æ§åˆ¶å™¨ï¼ˆç»§æ‰¿ `GanttController`ï¼‰ |
| `sample` | âŒ å¦ | `False` | å¯ç”¨ç¤ºä¾‹æ•°æ®ï¼ˆå¼€å‘è°ƒè¯•ç”¨ï¼‰ |
| `dependency_arrow` | âŒ å¦ | â€” | ä»»åŠ¡ä¾èµ–å­—æ®µï¼ˆ`Many2many` æˆ– `Many2one`ï¼ŒæŒ‡å‘åŒæ¨¡å‹ï¼‰ |
| `progress` | âŒ å¦ | â€” | è¿›åº¦ç™¾åˆ†æ¯”å­—æ®µï¼ˆ0â€“100ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡ï¼‰ |
| `consolidation` | âŒ å¦ | `False` | æ˜¯å¦å¯ç”¨â€œåˆå¹¶æ¨¡å¼â€ï¼ˆå°†ä»»åŠ¡æŒ‰æŸå­—æ®µèšåˆæ˜¾ç¤ºï¼‰ |
| `consolidate_by` | âŒ å¦ | â€” | åˆå¹¶ä¾æ®å­—æ®µï¼ˆéœ€ `consolidation="True"`ï¼‰ |
| `default_group_by` | âŒ å¦ | â€” | é»˜è®¤åˆ†ç»„å­—æ®µï¼ˆå¦‚ `project_id`ï¼‰ |
| `colors` | âŒ å¦ | â€” | åŠ¨æ€é¢œè‰²è§„åˆ™ï¼ˆè¯­æ³•ï¼š`color: condition; ...`ï¼‰ |

> ğŸ” **æ—¶é—´å­—æ®µç»„åˆé€»è¾‘**ï¼š
> - è‹¥åŒæ—¶æä¾› `date_stop` å’Œ `date_delay`ï¼Œ**ä¼˜å…ˆä½¿ç”¨ `date_stop`**ã€‚
> - è‹¥åªæœ‰ `date_start` + `date_delay`ï¼Œåˆ™ `date_stop = date_start + timedelta(hours=date_delay)`ã€‚

---

### äºŒã€`<field>` å…ƒç´ å±æ€§

| å±æ€§ | è¯´æ˜ |
|------|------|
| `name` | âœ… å¿…å¡«ï¼šå­—æ®µåï¼ˆå¿…é¡»å­˜åœ¨äºæ¨¡å‹ä¸­ï¼‰ |
| å…¶ä»–å±æ€§ï¼ˆ`widget`, `options`, `invisible` ç­‰ï¼‰ | âŒ **å…¨éƒ¨æ— æ•ˆ** |

> ğŸ“Œ **å¿…é¡»å£°æ˜çš„å­—æ®µ**ï¼š
> - æ‰€æœ‰ç”¨äº `date_start`ã€`date_stop`ã€`progress`ã€`dependency_arrow`ã€`colors`ã€`default_group_by` çš„å­—æ®µã€‚
> - ä»»åŠ¡å¡ç‰‡ä¸Šæ˜¾ç¤ºçš„å­—æ®µï¼ˆå¦‚ `name`ã€`user_id`ï¼‰ã€‚

---

### ä¸‰ã€`<attribute>` å…ƒç´ ï¼šåŠ¨æ€æ ·å¼ï¼ˆDecorationï¼‰

| å±æ€§å | æ•ˆæœ | è¯´æ˜ |
|--------|------|------|
| `decoration-danger` | çº¢è‰²è¾¹æ¡†/æ–‡å­— | å¦‚ï¼š`priority == '1'` |
| `decoration-warning` | æ©™è‰² | å¦‚ï¼š`progress < 50` |
| `decoration-success` | ç»¿è‰² | |
| `decoration-info` | è“è‰² | |
| `decoration-muted` | ç°è‰² | |
| `decoration-bf` | **ç²—ä½“** | |
| `decoration-it` | *æ–œä½“* | |

> âš ï¸ **æ³¨æ„**ï¼š  
> åœ¨ Gantt ä¸­ï¼Œ`decoration` ä¸»è¦å½±å“**ä»»åŠ¡å¡ç‰‡çš„æ–‡æœ¬æ ·å¼**ï¼Œè€ŒéèƒŒæ™¯è‰²ï¼ˆèƒŒæ™¯è‰²ç”± `colors` æ§åˆ¶ï¼‰ã€‚

---

### å››ã€`colors` å±æ€§è¯­æ³•è¯¦è§£

- **æ ¼å¼**ï¼š`"color1: condition1; color2: condition2; ..."`
- **é¢œè‰²å€¼**ï¼šCSS é¢œè‰²åç§°ï¼ˆå¦‚ `red`ï¼‰ã€åå…­è¿›åˆ¶ï¼ˆå¦‚ `#ff0000`ï¼‰æˆ– RGBã€‚
- **æ¡ä»¶**ï¼šPython é£æ ¼è¡¨è¾¾å¼ï¼ˆæ”¯æŒ `==`, `!=`, `<`, `>`, `in`, `and`, `or` ç­‰ï¼‰ã€‚
- **ä¼˜å…ˆçº§**ï¼šä»å·¦åˆ°å³åŒ¹é…ï¼Œ**ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç”Ÿæ•ˆ**ã€‚

âœ… ç¤ºä¾‹ï¼š
```xml
colors="red:state=='done'; green:progress>=80; orange:priority=='1'"
```

---

### äº”ã€ä»»åŠ¡ä¾èµ–ï¼ˆDependencyï¼‰è¦æ±‚

| è¦æ±‚ | è¯´æ˜ |
|------|------|
| å­—æ®µç±»å‹ | `Many2one`ï¼ˆæŒ‡å‘åŒæ¨¡å‹ï¼‰æˆ– `Many2many` |
| æ•°æ®å…³ç³» | ä¾èµ–ä»»åŠ¡å¿…é¡»å·²å­˜åœ¨ï¼ˆä¸èƒ½å¾ªç¯ä¾èµ–ï¼‰ |
| æ˜¾ç¤ºæ•ˆæœ | è‡ªåŠ¨ç»˜åˆ¶ç®­å¤´ä»å‰ç½®ä»»åŠ¡æŒ‡å‘å½“å‰ä»»åŠ¡ |

> ğŸ“ ç¤ºä¾‹æ¨¡å‹å®šä¹‰ï¼š
> ```python
> dependency_task_ids = fields.Many2many('project.task', relation='task_dependency_rel')
> ```

---

### å…­ã€ç”¨æˆ·äº¤äº’åŠŸèƒ½ï¼ˆè‡ªåŠ¨æä¾›ï¼‰

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **æ‹–æ‹½è°ƒæ•´æ—¶é—´** | æ‹–åŠ¨ä»»åŠ¡å¡ç‰‡å·¦å³ç§»åŠ¨ï¼ˆä¿®æ”¹ `date_start`/`date_stop`ï¼‰ |
| **è°ƒæ•´æŒç»­æ—¶é—´** | æ‹–åŠ¨å¡ç‰‡å³è¾¹ç¼˜ï¼ˆä¿®æ”¹ `date_delay` æˆ– `date_stop`ï¼‰ |
| **åˆ†ç»„åˆ‡æ¢** | ç‚¹å‡»åˆ†ç»„æ ‡é¢˜æˆ–ä½¿ç”¨ä¸‹æ‹‰èœå•åˆ‡æ¢åˆ†ç»„å­—æ®µ |
| **ç¼©æ”¾æ—¶é—´è½´** | é€šè¿‡ `mode` åˆ‡æ¢æ—¥/å‘¨/æœˆ/å¹´è§†å›¾ |
| **åˆ›å»ºä»»åŠ¡** | åŒå‡»æ—¶é—´è½´ç©ºç™½å¤„ï¼ˆéœ€æƒé™ï¼‰ |
| **ä¾èµ–è¿çº¿** | è‡ªåŠ¨æ ¹æ® `dependency_arrow` å­—æ®µç»˜åˆ¶ |

---

### ä¸ƒã€é™åˆ¶ä¸æ³¨æ„äº‹é¡¹

1. **ä»…é™ Enterprise**ï¼šç¤¾åŒºç‰ˆæ— æ³•ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ â€œView type 'gantt' is not supportedâ€ã€‚
2. **æ€§èƒ½æ•æ„Ÿ**ï¼šå¤§é‡ä»»åŠ¡ï¼ˆ>1000ï¼‰å¯èƒ½å¯¼è‡´æµè§ˆå™¨å¡é¡¿ã€‚
3. **æ—¶é—´å­—æ®µç²¾åº¦**ï¼š
   - `Datetime` å­—æ®µä¼šå¿½ç•¥æ—¶åŒºï¼ˆå‰ç«¯æŒ‰æµè§ˆå™¨æœ¬åœ°æ—¶åŒºæ˜¾ç¤ºï¼‰ã€‚
   - å»ºè®®ç»Ÿä¸€ä½¿ç”¨ `Date` å­—æ®µé¿å…æ—¶åŒºé—®é¢˜ã€‚
4. **ä¾èµ–å­—æ®µé™åˆ¶**ï¼šä¸æ”¯æŒ `One2many`ï¼Œå¿…é¡»æ˜¯ `Many2one` æˆ– `Many2many`ã€‚
5. **æ— å†…è”ç¼–è¾‘**ï¼šä»»åŠ¡ä¿¡æ¯éœ€ç‚¹å‡»å¡ç‰‡ååœ¨ä¾§è¾¹è¡¨å•ä¸­ç¼–è¾‘ã€‚

---

## âœ… æœ€ä½³å®è·µå»ºè®®

- **åˆç†é€‰æ‹©æ—¶é—´å­—æ®µ**ï¼šä¼˜å…ˆä½¿ç”¨ `date_start` + `date_stop`ï¼Œé¿å…ä¾èµ– `date_delay` è®¡ç®—è¯¯å·®ã€‚
- **è®¾ç½®é»˜è®¤åˆ†ç»„**ï¼šé€šè¿‡ `default_group_by="project_id"` æå‡ç”¨æˆ·ä½“éªŒã€‚
- **ä½¿ç”¨ colors é«˜äº®å…³é”®ä»»åŠ¡**ï¼šå¦‚é«˜ä¼˜å…ˆçº§ã€å»¶æœŸä»»åŠ¡ã€‚
- **æµ‹è¯•ä¾èµ–å…³ç³»**ï¼šç¡®ä¿ `dependency_task_ids` æ•°æ®ä¸€è‡´ï¼Œé¿å…å¾ªç¯ä¾èµ–ã€‚
- **æ§åˆ¶ä»»åŠ¡æ•°é‡**ï¼šé€šè¿‡ SearchView çš„ domain è¿‡æ»¤æ— å…³ä»»åŠ¡ã€‚

---

## ğŸ§© å…¸å‹åº”ç”¨åœºæ™¯

### åœºæ™¯ï¼šé¡¹ç›®ç®¡ç†
```xml
<gantt
    date_start="start_date"
    date_stop="end_date"
    progress="progress"
    default_group_by="project_id"
    dependency_arrow="depend_on_ids"
    colors="red:end_date &lt; today and state != 'done'"
>
    <field name="name"/>
    <field name="project_id"/>
    <field name="user_id"/>
    <field name="progress"/>
    <field name="start_date"/>
    <field name="end_date"/>
    <field name="depend_on_ids"/>
</gantt>
```

---

é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œä½ å¯ä»¥åœ¨ Odoo Enterprise 17 ä¸­æ„å»ºä¸“ä¸šçº§çš„é¡¹ç›®è®¡åˆ’ç”˜ç‰¹å›¾ã€‚è®°ä½ï¼š**Gantt è§†å›¾æ˜¯é¡¹ç›®ç®¡ç†çš„æ ¸å¿ƒå·¥å…·**ï¼Œåˆç†åˆ©ç”¨å…¶å±æ€§èƒ½æå¤§æå‡å›¢é˜Ÿåä½œæ•ˆç‡ã€‚